{% extends 'base.html' %}
{% block content %}

<style>
    body {
        background: linear-gradient(to right, #5dbde6, #004aad);
        color: white;
        font-family: Arial, sans-serif;
    }

    h1 {
        text-align: center;
        margin-top: 20px;
    }

    .painel-btns {
        text-align: center;
        margin: 20px 0;
    }

    .painel-btns button {
        background-color: whitesmoke;
        color: #004aad;
        border: none;
        padding: 10px 20px;
        margin: 5px;
        border-radius: 8px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.2s;
    }

    .painel-btns button:hover {
        background-color: #e3e3e3;
        transform: scale(1.05);
    }

    .secao {
        display: none;
        background-color: rgba(255, 255, 255, 0.15);
        border-radius: 10px;
        padding: 15px;
        margin: 15px auto;
        width: 90%;
        color: white;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
    }

    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: center;
    }

    th {
        background-color: rgba(0, 0, 0, 0.3);
    }

    a.btn {
        text-decoration: none;
        color: #004aad;
        background: whitesmoke;
        padding: 6px 10px;
        border-radius: 6px;
        margin: 0 3px;
    }

    a.btn:hover {
        background-color: #ddd;
    }
</style>

<h1>Painel Administrativo - Coordenação</h1>

<div class="painel-btns">
    <button onclick="mostrarSecao('turmas')">Turmas</button>
    <button onclick="mostrarSecao('disciplinas')">Disciplinas</button>
    <button onclick="mostrarSecao('notas')">Notas</button>
    <button onclick="mostrarSecao('advertencias')">Advertências</button>
</div>

{% if messages %}
    <ul style="text-align:center; list-style:none;">
        {% for message in messages %}
            <li style="color: yellow;">{{ message }}</li>
        {% endfor %}
    </ul>
{% endif %}

<!-- SEÇÃO TURMAS -->
<div id="turmas" class="secao">
    <h2>Gerenciar Turmas</h2>
    <a href="{% url 'cadastrar_turma' %}" class="btn">+ Nova Turma</a>
    <table>
        <tr><th>Nome</th><th>Disciplinas</th><th>Alunos</th><th>Ações</th></tr>
        {% for turma in turmas %}
        <tr>
            <td>{{ turma.nome }}</td>
            <td>
                {% for disc in turma.disciplinas.all %}
                    {{ disc.nome }}{% if not forloop.last %}, {% endif %}
                {% empty %}
                    <em>Sem disciplinas</em>
                {% endfor %}
            </td>
            <td>
                {% for aluno in turma.alunos.all %}
                    {{ aluno.nome }}{% if not forloop.last %}, {% endif %}
                {% empty %}
                    <em>Sem alunos</em>
                {% endfor %}
            </td>
            <td>
                <a href="{% url 'editar_turma' turma.id %}" class="btn">Editar</a>
                <a href="{% url 'deletar_turma' turma.id %}" class="btn"
                   onclick="return confirm('Excluir esta turma?')">Excluir</a>
            </td>
        </tr>
        {% empty %}
        <tr><td colspan="4">Nenhuma turma cadastrada.</td></tr>
        {% endfor %}
    </table>
</div>

<!-- SEÇÃO DISCIPLINAS -->
<div id="disciplinas" class="secao">
    <h2>Gerenciar Disciplinas</h2>
    <a href="{% url 'cadastrar_disciplina' %}" class="btn">+ Nova Disciplina</a>
    <table>
        <tr><th>Nome</th><th>Professor</th><th>Ações</th></tr>
        {% for disc in disciplinas %}
        <tr>
            <td>{{ disc.nome }}</td>
            <td>{{ disc.professor.nome }}</td>
            <td>
                <a href="{% url 'editar_disciplina' disc.id %}" class="btn">Editar</a>
                <a href="{% url 'deletar_disciplina' disc.id %}" class="btn"
                   onclick="return confirm('Excluir esta disciplina?')">Excluir</a>
            </td>
        </tr>
        {% empty %}
        <tr><td colspan="3">Nenhuma disciplina cadastrada.</td></tr>
        {% endfor %}
    </table>
</div>

<!-- SEÇÃO NOTAS -->
<div id="notas" class="secao">
    <h2>Notas Lançadas</h2>
    <table>
        <tr><th>Aluno</th><th>Disciplina</th><th>Nota</th><th>Data</th></tr>
        {% for nota in notas %}
        <tr>
            <td>{{ nota.aluno.nome }}</td>
            <td>{{ nota.disciplina.nome }}</td>
            <td>{{ nota.valor }}</td>
            <td>{{ nota.data_lancamento }}</td>
        </tr>
        {% empty %}
        <tr><td colspan="4">Nenhuma nota registrada.</td></tr>
        {% endfor %}
    </table>
</div>

<!-- SEÇÃO ADVERTÊNCIAS -->
<div id="advertencias" class="secao">
    <h2>Advertências</h2>
    <a href="{% url 'coordenacao' %}" class="btn">+ Nova Advertência</a>
    <table>
        <tr><th>Aluno</th><th>Motivo</th><th>Data</th><th>Status</th><th>Ações</th></tr>
        {% for adv in advertencias %}
        <tr>
            <td>{{ adv.aluno.nome }}</td>
            <td>{{ adv.motivo }}</td>
            <td>{{ adv.data }}</td>
            <td>{{ adv.get_status_display }}</td>
            <td>
                <a href="{% url 'editar_advertencia' adv.id %}" class="btn">Editar</a>
                <a href="{% url 'deletar_advertencia' adv.id %}" class="btn"
                   onclick="return confirm('Excluir esta advertência?')">Excluir</a>
            </td>
        </tr>
        {% empty %}
        <tr><td colspan="5">Nenhuma advertência registrada.</td></tr>
        {% endfor %}
    </table>
</div>

<script>
    function mostrarSecao(id) {
        document.querySelectorAll('.secao').forEach(s => s.style.display = 'none');
        document.getElementById(id).style.display = 'block';
    }
</script>

{% endblock %}
